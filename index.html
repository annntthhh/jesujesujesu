<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para Mi Amor</title>
    <link href="https://fonts.googleapis.com/css2?family=Sacramento&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="main.css"> 
</head>
<body>

    <div id="bloqueador" class="bloqueador-pantalla">
        <h2>Ingresa la Clave Secreta</h2>
        <input type="password" id="claveInput" placeholder="Introduce la clave">
        <button id="claveBoton">Abrir Tarjeta</button>
        <p id="mensajeError">Clave incorrecta. ¡Inténtalo de nuevo!</p>
    </div>

    <div id="tarjetaContenido" class="tarjeta-contenedor oculto">
        <div class="tarjeta volteable" onclick="this.classList.toggle('girar')">

            <div class="frente">
                <h1>Para el amor de mi vida</h1> 

                <div class="corazon-animado"></div>

                <div class="contenido-mensaje">
                    <p>Este es otro detalle especial solo para ti</p>
                    <p>Te envío todo mi amor en esta pequeña tarjetita.</p>
                    <p class="firma">- Ane</p>
                </div>
            </div>
            <div class="reverso">
                <div class="contenido-mensaje reverso-contenido">
                    <h2>¡Una sorpresa solo para ti!</h2>
                    <hr>
                    <p>Sabes que eres lo más importante para mí. Cada día a tu lado es un regalo, y aunque esta tarjeta sea pequeña, la hice con todo el amor y la dedicación que mereces. Espero que te haya gustado este detalle. ¡Te amo!</p>
                </div>
            </div>
            </div>
    </div>

    <script>
        // --- CONFIGURACIÓN DE LA CLAVE ---
        const CLAVE_SECRETA = "8888"; // !!! CAMBIA ESTA CLAVE SI ES NECESARIO !!!
        // ---------------------------------
        
        const bloqueador = document.getElementById('bloqueador');
        const tarjetaContenido = document.getElementById('tarjetaContenido');
        const claveInput = document.getElementById('claveInput');
        const claveBoton = document.getElementById('claveBoton');
        const mensajeError = document.getElementById('mensajeError');
        
        let intervaloCorazones;
        let intervaloBesitos; 

        // --- FUNCIÓN DE VERIFICACIÓN DE CLAVE ---
        function verificarClave() {
            if (claveInput.value.toLowerCase() === CLAVE_SECRETA) {
                // Clave correcta: ocultar bloqueador y mostrar tarjeta
                bloqueador.style.opacity = 0;
                
                // 1. DETENER LA CREACIÓN DE NUEVOS CORAZONES Y BESITOS
                clearInterval(intervaloCorazones);
                clearInterval(intervaloBesitos); 

                // 2. ELIMINAR LOS CORAZONES Y BESITOS EXISTENTES (LIMPIEZA)
                document.querySelectorAll('.corazon-flotante, .besito-flotante').forEach(elemento => {
                    elemento.style.transition = 'opacity 0.5s';
                    elemento.style.opacity = 0;
                    setTimeout(() => elemento.remove(), 500);
                });

                // 3. Esperar a que la transición de opacidad termine antes de ocultar
                setTimeout(() => { 
                    bloqueador.style.display = 'none';
                    tarjetaContenido.classList.remove('oculto');
                }, 500); 

            } else {
                // Clave incorrecta: mostrar mensaje de error
                mensajeError.style.opacity = 1;
                claveInput.value = ''; 
                claveInput.focus(); 
                setTimeout(() => { mensajeError.style.opacity = 0; }, 2000);
            }
        }

        // Eventos para el botón y la tecla Enter
        claveBoton.addEventListener('click', verificarClave);
        claveInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                verificarClave();
            }
        });

        // ----------------------------------------------------
        // LÓGICA DE CORAZONES Y BESITOS FLOTANTES EN PANTALLA DE CLAVE 
        // ----------------------------------------------------
        
        // Función general para crear cualquier elemento flotante
        function crearElementoFlotante(clase, animacion) {
            if (bloqueador.style.display === 'none' || bloqueador.style.opacity === '0') {
                return;
            }
            
            const elemento = document.createElement('div');
            elemento.classList.add(clase);
            
            const anchoPantalla = window.innerWidth;
            
            // Ajustar el rango de aparición para centrar la animación
            const rangoX = (clase === 'corazon-flotante') ? (anchoPantalla * 0.5) : (anchoPantalla * 0.7);
            const inicioX = (anchoPantalla - rangoX) / 2;
            const posicionX = Math.random() * rangoX + inicioX; 

            elemento.style.left = posicionX + 'px';
            
            let duracion = Math.random() * 5 + 5; 
            const origen = (Math.random() < 0.5) ? 'arriba' : 'abajo';

            if (origen === 'arriba') {
                elemento.style.top = '-50px';
                // Animación de flotación hacia abajo
                elemento.style.animation = `${animacion === 'tenue' ? 'flotar-tenue' : 'flotar-abajo'} ${duracion}s linear forwards`;
            } else { // 'abajo'
                elemento.style.bottom = '-50px';
                // Animación de flotación hacia arriba
                elemento.style.animation = `${animacion === 'tenue' ? 'flotar-tenue' : 'flotar-arriba'} ${duracion}s linear forwards`;
            }
            
            document.body.appendChild(elemento);

            // Eliminar el elemento una vez que su animación termina
            setTimeout(() => {
                elemento.remove();
            }, duracion * 1000 + 500);
        }

        // Lanzar un corazón normal (Animación 'normal')
        function lanzarCorazon() {
            crearElementoFlotante('corazon-flotante', 'normal');
        }
        
        // Lanzar un besito (Animación 'tenue')
        function lanzarBesitoTenue() {
            crearElementoFlotante('besito-flotante', 'tenue');
        }

        // Iniciar el lanzamiento de corazones cada 500ms
        intervaloCorazones = setInterval(lanzarCorazon, 500);
        
        // Iniciar el lanzamiento de besitos cada 1000ms (Más lento)
        intervaloBesitos = setInterval(lanzarBesitoTenue, 1000);


        // ----------------------------------------------------
        // Lógica del Besito (DOBLE CLIC)
        // ----------------------------------------------------
        document.addEventListener('dblclick', function(e) {
            // Solo activar los besitos si la tarjeta es visible
            if (bloqueador.style.display !== 'none') {
                return; 
            }
            
            var besito = document.createElement('div');
            besito.classList.add('besito');
            besito.style.left = (e.clientX - 10) + 'px';
            besito.style.top = (e.clientY - 10) + 'px';
            document.body.appendChild(besito);

            setTimeout(function() {
                besito.remove();
            }, 1000); 
        });
    </script>

</body>
</html>
